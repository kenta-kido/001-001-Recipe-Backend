(function(){"use strict";var e={9731:function(e,t,r){var o=r(5130),s=r(6768);const a={id:"app"};function n(e,t,r,o,n,i){const l=(0,s.g2)("HeaderComponent"),u=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",a,[(0,s.bF)(l),(0,s.bF)(u)])}var i=r(4232);const l={class:"header"},u={key:0,class:"user-info"};function d(e,t,r,o,a,n){const d=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("header",l,[(0,s.Lk)("nav",null,[(0,s.bF)(d,{to:"/"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)("Home")]))),_:1}),a.isLoggedIn?((0,s.uX)(),(0,s.CE)("a",{key:1,onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e)),style:{cursor:"pointer"}},"Logout")):((0,s.uX)(),(0,s.Wv)(d,{key:0,to:"/login"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("Login")]))),_:1})),a.isLoggedIn&&"ROLE_ADMIN"===a.userRole?((0,s.uX)(),(0,s.Wv)(d,{key:2,to:"/dashboard",style:{cursor:"pointer"}},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)("Admin Dashboard")]))),_:1})):(0,s.Q3)("",!0)]),a.isLoggedIn?((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("p",null,"Welcome "+(0,i.v_)(a.userEmail)+" ("+(0,i.v_)(a.userRole)+")",1)])):(0,s.Q3)("",!0)])}r(4114);var c={name:"HeaderComponent",data(){return{isLoggedIn:!1,userEmail:"",userRole:""}},mounted(){this.isLoggedIn=!!localStorage.getItem("accessToken"),this.userEmail=localStorage.getItem("userEmail")||"",this.userRole=localStorage.getItem("userRole")||"",window.addEventListener("authChanged",this.updateAuthStatus)},beforeUnmount(){window.removeEventListener("authChanged",this.updateAuthStatus)},methods:{logout(){localStorage.removeItem("accessToken"),localStorage.removeItem("userEmail"),localStorage.removeItem("userRole"),this.isLoggedIn=!1,window.dispatchEvent(new Event("authChanged")),this.$router.push("/")},updateAuthStatus(){this.isLoggedIn=!!localStorage.getItem("accessToken"),this.userEmail=localStorage.getItem("userEmail")||"",this.userRole=localStorage.getItem("userRole")||""}}},h=r(1241);const m=(0,h.A)(c,[["render",d],["__scopeId","data-v-06351b7c"]]);var p=m,f={name:"App",components:{HeaderComponent:p}};const g=(0,h.A)(f,[["render",n]]);var k=g,v=r(1387);const L={class:"home"};function w(e,t,r,o,a,n){return(0,s.uX)(),(0,s.CE)("div",L,t[0]||(t[0]=[(0,s.Lk)("h1",null,"Home",-1)]))}var I={name:"HomePage"};const E=(0,h.A)(I,[["render",w],["__scopeId","data-v-ebad1db2"]]);var b=E;const A={key:0},R=["disabled"],y=["disabled"],S={key:1},C={key:2},_={key:3,style:{color:"red"}};function U(e,t,r,a,n,l){return(0,s.uX)(),(0,s.CE)("div",null,[t[6]||(t[6]=(0,s.Lk)("h2",null,"Login",-1)),(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>l.handleLogin&&l.handleLogin(...e)),["prevent"]))},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),placeholder:"Email",type:"email"},null,512),[[o.Jo,n.email]]),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),placeholder:"Password",type:"password"},null,512),[[o.Jo,n.password]]),t[5]||(t[5]=(0,s.Lk)("button",{type:"submit"},"Login",-1))],32),n.token?((0,s.uX)(),(0,s.CE)("div",A,"Token: "+(0,i.v_)(n.token),1)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.accessAdminEndpoint&&l.accessAdminEndpoint(...e)),disabled:!n.token||"ROLE_ADMIN"!==n.userRole},"Access Admin Endpoint",8,R),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>l.accessSecuredEndpoint&&l.accessSecuredEndpoint(...e)),disabled:!n.token},"Access Secured Endpoint",8,y),n.adminData?((0,s.uX)(),(0,s.CE)("div",S,"Admin Data: "+(0,i.v_)(n.adminData),1)):(0,s.Q3)("",!0),n.securedData?((0,s.uX)(),(0,s.CE)("div",C,"Secured Data: "+(0,i.v_)(n.securedData),1)):(0,s.Q3)("",!0),n.errorMessage?((0,s.uX)(),(0,s.CE)("div",_,"Error: "+(0,i.v_)(n.errorMessage),1)):(0,s.Q3)("",!0)])}r(1454),r(4979);var x=r(4373);const D=x.A.create({baseURL:"https://morning-temple-77648-10e1a6020960.herokuapp.com"});var P=D;function $(e){const t=e.split(".")[1],r=t.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(r).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(o)}var O={data(){return{email:"",password:"",token:"",userRole:"",adminData:"",securedData:"",errorMessage:""}},methods:{async handleLogin(){try{const e=await P.post("/auth/login",{email:this.email,password:this.password});this.token=e.data.accessToken,localStorage.setItem("accessToken",this.token);const t=$(this.token),r=t.e,o=t.a[0];localStorage.setItem("userEmail",r),localStorage.setItem("userRole",o),this.userRole=o,window.dispatchEvent(new Event("authChanged")),this.errorMessage="","ROLE_ADMIN"===o?this.$router.push("/admin"):this.$router.push("/user")}catch(e){console.error("Login failed:",e),this.errorMessage="Invalid email or password.",this.token=""}},async accessAdminEndpoint(){if(this.token&&"ROLE_ADMIN"===this.userRole)try{const e=await P.get("/admin",{headers:{Authorization:`Bearer ${this.token}`}});this.adminData=e.data,this.errorMessage=""}catch(e){console.error("Access to admin endpoint failed:",e),this.errorMessage="Access denied or insufficient permissions.",this.adminData="Access denied"}else this.errorMessage="Access denied. Admins only."},async accessSecuredEndpoint(){if(this.token)try{const e=await P.get("/secured",{headers:{Authorization:`Bearer ${this.token}`}});this.securedData=e.data,this.errorMessage=""}catch(e){console.error("Access to secured endpoint failed:",e),this.errorMessage="Access denied or insufficient permissions.",this.securedData="Access denied"}}},mounted(){const e=localStorage.getItem("accessToken"),t=localStorage.getItem("userRole");e&&(this.token=e,this.userRole=t)}};const M=(0,h.A)(O,[["render",U]]);var X=M;const T={key:0},N={key:1};function B(e,t,r,o,a,n){return(0,s.uX)(),(0,s.CE)("div",null,[t[2]||(t[2]=(0,s.Lk)("h2",null,"I am Admin",-1)),(0,s.Lk)("p",null,"User Role: "+(0,i.v_)(a.userRole),1),a.isAdmin?((0,s.uX)(),(0,s.CE)("div",T,t[0]||(t[0]=[(0,s.Lk)("p",null,"Welcome to the admin dashboard!",-1)]))):((0,s.uX)(),(0,s.CE)("div",N,t[1]||(t[1]=[(0,s.Lk)("h2",null,"Access Denied",-1),(0,s.Lk)("p",null,"You do not have permission to view this page.",-1)])))])}var q={data(){return{isAdmin:!1,userRole:""}},mounted(){const e=localStorage.getItem("userRole");this.userRole=e,"ROLE_ADMIN"===e&&(this.isAdmin=!0)}};const F=(0,h.A)(q,[["render",B],["__scopeId","data-v-56a5bde2"]]);var j=F;const Q={class:"table-container"},V=["onClick"],z=["onClick"];function J(e,t,r,o,a,n){return(0,s.uX)(),(0,s.CE)("div",null,[t[2]||(t[2]=(0,s.Lk)("h1",null,"This is DashBoard",-1)),t[3]||(t[3]=(0,s.Lk)("h2",null,"User List",-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$router.push("/dashboard/user-create"))},"Add New User"),(0,s.Lk)("div",Q,[(0,s.Lk)("table",null,[t[1]||(t[1]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"ID"),(0,s.Lk)("th",null,"Email"),(0,s.Lk)("th",null,"Role"),(0,s.Lk)("th",null,"Extra Info"),(0,s.Lk)("th",null,"Actions"),(0,s.Lk)("th",null,"Delete")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.users,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,i.v_)(e.id),1),(0,s.Lk)("td",null,(0,i.v_)(e.email),1),(0,s.Lk)("td",null,(0,i.v_)(e.role),1),(0,s.Lk)("td",null,(0,i.v_)(e.extraInfo),1),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:t=>n.editUser(e.id)},"Edit",8,V)]),(0,s.Lk)("td",null,[1!==e.id?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t=>n.deleteUser(e.id)},"Delete",8,z)):(0,s.Q3)("",!0)])])))),128))])])])])}var W={name:"DashBoard",data(){return{users:[]}},mounted(){this.fetchUsers()},methods:{async fetchUsers(){try{const e=await P.get("/admin/users",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});this.users=e.data}catch(e){console.error("Error fetching users:",e),alert("Failed to fetch users.")}},editUser(e){this.$router.push(`/dashboard/user-edit/${e}`)},async deleteUser(e){if(confirm("Are you sure you want to delete this user?"))try{await P.delete(`/admin/users/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),alert("User deleted successfully."),this.fetchUsers()}catch(t){console.error("Error deleting user:",t),alert("Failed to delete user.")}}}};const H=(0,h.A)(W,[["render",J],["__scopeId","data-v-283ba8da"]]);var Y=H;function K(e,t){return(0,s.uX)(),(0,s.CE)("div",null,t[0]||(t[0]=[(0,s.Lk)("h2",null,"This is a user page",-1)]))}const G={},Z=(0,h.A)(G,[["render",K]]);var ee=Z;function te(e,t,r,a,n,i){return(0,s.uX)(),(0,s.CE)("div",null,[t[9]||(t[9]=(0,s.Lk)("h2",null,"Create New User",-1)),(0,s.Lk)("form",{onSubmit:t[3]||(t[3]=(0,o.D$)(((...e)=>i.createUser&&i.createUser(...e)),["prevent"]))},[(0,s.Lk)("div",null,[t[4]||(t[4]=(0,s.Lk)("label",{for:"email"},"Email:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.user.email=e),required:""},null,512),[[o.Jo,n.user.email]])]),(0,s.Lk)("div",null,[t[5]||(t[5]=(0,s.Lk)("label",{for:"extraInfoRaw"},"Extra Info:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"extraInfoRaw","onUpdate:modelValue":t[1]||(t[1]=e=>n.user.extraInfoRaw=e)},null,512),[[o.Jo,n.user.extraInfoRaw]])]),(0,s.Lk)("div",null,[t[7]||(t[7]=(0,s.Lk)("label",{for:"role"},"Role:",-1)),(0,s.bo)((0,s.Lk)("select",{id:"role","onUpdate:modelValue":t[2]||(t[2]=e=>n.user.role=e),required:""},t[6]||(t[6]=[(0,s.Lk)("option",{value:"ROLE_USER"},"User",-1),(0,s.Lk)("option",{value:"ROLE_ADMIN"},"Admin",-1)]),512),[[o.u1,n.user.role]])]),t[8]||(t[8]=(0,s.Lk)("button",{type:"submit"},"Done",-1))],32)])}var re={name:"DashBoardUserCreate",data(){return{user:{email:"",extraInfoRaw:"",extraInfo:"",role:"ROLE_USER",password:""}}},mounted(){this.generatePassword()},methods:{generatePassword(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<10;r++)t+=e.charAt(Math.floor(Math.random()*e.length));this.user.password=t,this.user.extraInfo=`[Init Pass: ${t}] ${this.user.extraInfoRaw}`},async createUser(){this.user.extraInfo=`[Init Pass: ${this.user.password}] ${this.user.extraInfoRaw}`;try{await P.post("/admin/users",{email:this.user.email,extraInfo:this.user.extraInfo,role:this.user.role,password:this.user.password},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),this.$router.push("/dashboard")}catch(e){console.error("Error creating user:",e),alert("Failed to create user.")}}}};const oe=(0,h.A)(re,[["render",te],["__scopeId","data-v-0473c016"]]);var se=oe;const ae={key:0,class:"form-group"},ne={id:"newPassword",class:"new-password-display"};function ie(e,t,r,a,n,l){return(0,s.uX)(),(0,s.CE)("div",null,[t[11]||(t[11]=(0,s.Lk)("h2",null,"Edit User",-1)),(0,s.Lk)("form",{onSubmit:t[4]||(t[4]=(0,o.D$)(((...e)=>l.updateUser&&l.updateUser(...e)),["prevent"]))},[(0,s.Lk)("div",null,[t[5]||(t[5]=(0,s.Lk)("label",{for:"email"},"Email:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.user.email=e),required:""},null,512),[[o.Jo,n.user.email]])]),(0,s.Lk)("div",null,[t[6]||(t[6]=(0,s.Lk)("label",{for:"extraInfoRaw"},"Extra Info:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"extraInfoRaw","onUpdate:modelValue":t[1]||(t[1]=e=>n.user.extraInfoRaw=e)},null,512),[[o.Jo,n.user.extraInfoRaw]])]),n.user.password?((0,s.uX)(),(0,s.CE)("div",ae,[t[7]||(t[7]=(0,s.Lk)("label",{for:"newPassword"},"New Password: ",-1)),(0,s.Lk)("span",ne,(0,i.v_)(n.user.password),1)])):(0,s.Q3)("",!0),(0,s.Lk)("div",null,[t[9]||(t[9]=(0,s.Lk)("label",{for:"role"},"Role:",-1)),(0,s.bo)((0,s.Lk)("select",{id:"role","onUpdate:modelValue":t[2]||(t[2]=e=>n.user.role=e),required:""},t[8]||(t[8]=[(0,s.Lk)("option",{value:"ROLE_USER"},"User",-1),(0,s.Lk)("option",{value:"ROLE_ADMIN"},"Admin",-1)]),512),[[o.u1,n.user.role]])]),t[10]||(t[10]=(0,s.Lk)("button",{type:"submit"},"Save Changes",-1)),1!==e.userId?((0,s.uX)(),(0,s.CE)("button",{key:1,type:"button",onClick:t[3]||(t[3]=(...e)=>l.resetPassword&&l.resetPassword(...e))},"Reset Password")):(0,s.Q3)("",!0)],32)])}var le={name:"DashBoardUserEdit",data(){return{user:{email:"",extraInfoRaw:"",extraInfo:"",role:"",password:""},originalPasswordInfo:""}},mounted(){this.userId=parseInt(this.$route.params.id,10),this.fetchUser()},methods:{async fetchUser(){try{const e=this.$route.params.id,t=await P.get(`/admin/users/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),r=t.data;this.user.email=r.email,this.user.extraInfoRaw=r.extraInfo.replace(/\[Init Pass: \w{10}\]\s*/,"").replace(/\[Reset Pass: \w{10}\]\s*/,""),this.user.role=r.role;const o=r.extraInfo.match(/\[Init Pass: (\w{10})\]/),s=r.extraInfo.match(/\[Reset Pass: (\w{10})\]/);this.originalPasswordInfo=s?s[0]:o?o[0]:"",this.user.password=s?s[1]:o?o[1]:""}catch(e){console.error("Error fetching user:",e),alert("Failed to fetch user.")}},generatePassword(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<10;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},resetPassword(){const e=this.generatePassword();this.originalPasswordInfo="",this.user.password=e},async updateUser(){try{const e=this.$route.params.id,t=`${this.originalPasswordInfo?this.originalPasswordInfo:`[Reset Pass: ${this.user.password}]`} ${this.user.extraInfoRaw?this.user.extraInfoRaw:""}`.trim(),r=await P.put(`/admin/users/${e}`,{email:this.user.email,extraInfo:t,role:this.user.role,password:this.user.password},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});console.log("Update Response:",r.data),this.$router.push("/dashboard")}catch(e){console.error("Error updating user:",e.response?.data||e.message),403===e.response?.status?alert("You do not have permission to update this user."):401===e.response?.status?(alert("Session expired. Please log in again."),this.$router.push("/login")):alert("Failed to update user. Please check the console for more details.")}}}};const ue=(0,h.A)(le,[["render",ie],["__scopeId","data-v-4149f4ce"]]);var de=ue;const ce=[{path:"/",component:b},{path:"/login",component:X},{path:"/admin",component:j,meta:{requiresAuth:!0,role:"ROLE_ADMIN"}},{path:"/dashboard",component:Y,meta:{requiresAuth:!0,role:"ROLE_ADMIN"}},{path:"/user",component:ee,meta:{requiresAuth:!0,role:"ROLE_USER"}},{path:"/dashboard/user-create",component:se,meta:{requiresAuth:!0,role:"ROLE_ADMIN"}},{path:"/dashboard/user-edit/:id",component:de,meta:{requiresAuth:!0,role:"ROLE_ADMIN"}}],he=(0,v.aE)({history:(0,v.LA)(),routes:ce});he.beforeEach(((e,t,r)=>{const o=localStorage.getItem("accessToken"),s=localStorage.getItem("userRole");e.meta.requiresAuth?o?e.meta.role&&e.meta.role!==s?r("/"):r():r("/login"):r()}));var me=he;(0,o.Ef)(k).use(me).mount("#app")}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.m=e,function(){var e=[];r.O=function(t,o,s,a){if(!o){var n=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],a=e[d][2];for(var i=!0,l=0;l<o.length;l++)(!1&a||n>=a)&&Object.keys(r.O).every((function(e){return r.O[e](o[l])}))?o.splice(l--,1):(i=!1,a<n&&(n=a));if(i){e.splice(d--,1);var u=s();void 0!==u&&(t=u)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,s,a]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,a,n=o[0],i=o[1],l=o[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(l)var d=l(r)}for(t&&t(o);u<n.length;u++)a=n[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(9731)}));o=r.O(o)})();
//# sourceMappingURL=app.b4c2d5e1.js.map